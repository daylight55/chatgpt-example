

ARPは、IPアドレスとMACアドレスを結び付けるためのプロトコルです。
ネットワークに接続されたコンピュータは、通信を行う際には、相手のMACアドレスを知っていなければなりません。
しかし、IPアドレスはコンピュータに割り当てられるだけで、MACアドレスはハードウェアに割り当てられています。
このため、コンピュータは自分のネットワークに接続されている他のコンピュータのMACアドレスを知る必要があります。
これがARPプロトコルの役割です。

ARPプロトコルは、IPアドレスとMACアドレスを結び付けるために使用されます。
通常、ARPテーブルにはエントリが2つあります。
1つ目はマシン自身のエントリで、2つ目はデフォルトゲートウェイのエントリです。
これら2つのエントリ以外にARPテーブルにはエントリを追加することもできます。
例えば、特定のサーバーとの通信の頻度が高い場合などです。

 ARPプロトコルの応用例としては、ARPキャッシュポisoning攻撃があります。
 この攻撃の目的は、通信の経路を誤って伝達させることです。
 一般的な方法は次のようなものです。

 1. 攻撃者が送信元 MAC アドレスを偽装して ARP パケットをブロードキャストします（フェイクパケット）。

 2. ターゲット機器はフェイクパケットを受信して ARP キャッシュテーブルに追加します（フェイクエントリ）

 3. ターゲット機器が送信先 IP アドレスに対応する MAC アドレスをフェイクパケットの送信元 MAC アドレスと認識します

 4. 次回ターゲット機器が同一の送信先 IP アドレス宛ての通信を行う際にフェイクパケットの送信元 MAC アドレスを使用してパケットを転送します

 5. 攻撃者はフェイクパケットの送信元 MAC アドレス宛てに転送されたパケットを受信します

 6. 攻撃者が受信したパケット内容を確認後、不正な内容の場合は破棄します

 7. 正規の通信内容の場合は再度フェイクパケットの発行から始めます（1〜6の工程を繰り返します）

 この手順で攻撃者はターゲット機器から送られたパケットの内容を盗聴・中間転送できるようになります。